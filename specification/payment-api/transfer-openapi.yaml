openapi: 3.1.0
info:
  title: Transfer API
  version: 2.6.6
servers:
  - url: https://sandbox-security-uat.finzly.io/auth/realms/BANKOS.UAT.SANDBOX.CUSTOMER/protocol/openid-connect/token
    description: Authentication
security:
  - oAuth2:
      - roles
tags:
  - name: Transfer
    description: APIs for transfer and waterfall payment operations.
paths:
  /v3/payments/booktransfer:
    post:
      tags:
        - Transfer
      summary: Initiate a Book (Transfer) Payment
      description: Initiate a transfer payment request
      operationId: booktransfer
      requestBody:
        description: Book Transfer [Transfer] Request Fields
        content:
          application/json:
            schema:
              $ref: ./payments-openapi.yaml#/components/schemas/BookTransferRequest
        required: true
      responses:
        "200":
          description: search results matching criteria
          content:
            application/json:
              schema:
                $ref: ./payments-openapi.yaml#/components/schemas/BookTransferResponse
        "400":
          description: bad input parameter environment
        "401":
          description: Unauthorized
        "403":
          description: Forbidden
        "404":
          description: Not Found
        "405":
          description: bad input parameter environment
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: ./payments-openapi.yaml#/components/schemas/Error
        "503":
          description: Service unavailable
        default:
          description: return payment response
          content:
            application/json:
              schema:
                $ref: ./payments-openapi.yaml#/components/schemas/BookTransferResponse
  /api/gateway/v1/payments/waterfall:
    post:
      tags:
        - Transfer
      summary: Waterfall transfers
      description: >
        Initiates a batch of internal fund transfers arranged in a waterfall
        sequence.

        Each payment in the batch is executed in priority order defined by its `paymentIndex`,

        where funds flow from the debtor to the creditor specified in each payment. The waterfall design

        allows funds to cascade through multiple accounts sequentially within the bank.

        **Note:** This API is restricted to use by authorized financial institutions only.
      operationId: createwaterfalltransfers
      parameters:
        - name: Idempotent-Key
          in: header
          description: >
            The idempotency key ensures that a payment request is processed only
            once. It must be unique for each batch of payments to prevent
            duplicate processing.
          required: true
          style: simple
          explode: false
          schema:
            type: string
            format: uuid
            example: 123e4567-e89b-12d3-a456-426614174000
      requestBody:
        description: Waterfall transfers Request fields
        content:
          application/json:
            schema:
              $ref: ./payments-openapi.yaml#/components/schemas/WaterfallTransferRequest
        required: true
      responses:
        "201":
          description: Waterfall transfers processed successfully
          content:
            application/json:
              schema:
                required:
                  - waterfallId
                type: object
                properties:
                  waterfallId:
                    type: string
                    description: Unique indentifier in Finzly system.
                    format: uuid
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                required:
                  - errors
                type: object
                properties:
                  errors:
                    type: array
                    description: >
                      List of validation errors encountered in the request.


                      The request was invalid due to malformed syntax or failed validation rules.

                      This may include missing required fields, incorrect data formats, or invalid account information within the payment batch.
                    items:
                      required:
                        - code
                        - message
                        - paymentIndex
                      type: object
                      properties:
                        message:
                          type: string
                          description: Human-readable message describing the error.
                          example: Payment Notes exceed the maximum limit of 200 characters.
                        code:
                          type: string
                          description: Error code identifier.
                          example: WF_PAYMENT_NOTES_MAX
                        paymentIndex:
                          type: integer
                          description: Index of the payment object where the error occurred.
                          example: 2
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                required:
                  - errors
                type: object
                properties:
                  errors:
                    type: array
                    description: >
                      List of authentication/authorization errors encountered
                      while processing the request.


                      The request lacks valid authentication credentials.

                      Ensure a valid access token or API key is included in the request headers.
                    items:
                      required:
                        - code
                        - message
                      type: object
                      properties:
                        message:
                          type: string
                          description: Error message describing why the request was unauthorized.
                          example: "Unable to process the request: no calling legal entity found for the
                            given batch. Please contact your administrator."
                        code:
                          type: string
                          description: Error code that identifies the origin of the error.
                          example: WF_CALLINGORG_UNAUTHORIZED
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                required:
                  - errors
                type: object
                properties:
                  errors:
                    type: array
                    description: >
                      List of authorization errors encountered while processing
                      the request.


                      The client is authenticated but does not have the necessary permissions to perform this operation or access the requested resource.
                    items:
                      required:
                        - code
                        - message
                      type: object
                      properties:
                        message:
                          type: string
                          description: Human-readable message describing why the request was forbidden.
                          example: You are not authorized to process this request.
                        code:
                          type: string
                          description: Error code that identifies the type of authorization error.
                          example: WF_ACCESS_DENIED
        "404":
          description: >
            Not Found - The requested resource could not be located. Verify the
            endpoint or resource identifier.
        "405":
          description: >
            Method Not Allowed - HTTP method used is not supported by the
            requested resource.
        "409":
          description: Conflict
          content:
            application/json:
              schema:
                required:
                  - errors
                type: object
                properties:
                  errors:
                    type: array
                    description: >
                      List of conflict errors encountered while processing the
                      request.


                      The request could not be completed due to a conflict with the current state of the target resource.

                      This often occurs when attempting to create a payment with an external reference ID, or idempotent key that already exists in the system.
                    items:
                      required:
                        - code
                        - message
                      type: object
                      properties:
                        message:
                          type: string
                          description: Error message explaining why the conflict occurred.
                          example: A batch with this idempotent key already exists. Please use a different
                            key or retrieve the existing batch.
                        code:
                          type: string
                          description: Error code that identifies the type of conflict.
                          example: WF_IDEMPOTENT_KEY_CONFLICT
        "500":
          description: Internal Server
          content:
            application/json:
              schema:
                required:
                  - errors
                type: object
                properties:
                  errors:
                    type: array
                    description: >
                      List of internal errors encountered during processing.


                      The server encountered an unexpected condition that prevented it from fulfilling the request. This could be due to a system error, database failure, or other internal issues.
                    items:
                      required:
                        - code
                        - message
                      type: object
                      properties:
                        message:
                          type: string
                          description: Description of the internal error.
                          example: Unexpected error occurred while processing the request.
                        code:
                          type: string
                          description: Internal error code for tracking and debugging.
                          example: WF_ERROR
        "503":
          description: |
            Service Unavailable - The server is temporarily unable.
      servers:
        - url: https://sandbox-digitalbanking-uat2.finzly.net
components:
  securitySchemes:
    oAuth2:
      $ref: ./payments-openapi.yaml#/components/securitySchemes/oAuth2
